# Qwen3-ASR 简易配置说明

## 📝 只需两步启用 Qwen3-ASR

### 第一步：安装依赖

```bash
pip install dashscope
```

### 第二步：修改主配置文件

**只需要修改项目根目录的 config.json 文件即可！**

在 **config.json** 中添加/修改以下配置：

```json
{
  "voice_to_text": "ali",
  "speech_recognition": true,
  "group_speech_recognition": true,
  "use_qwen3_asr": true,
  "dashscope_api_key": "sk-你的API密钥"
}
```

**就这么简单！不需要修改其他配置文件！**

## ✅ 完整配置示例

### 主配置文件 (项目根目录/config.json)

**最简配置（只需这些）：**
```json
{
  "channel_type": "wechatcom_app",
  "model": "dify",
  "voice_to_text": "ali",
  "speech_recognition": true,
  "group_speech_recognition": true,
  "use_qwen3_asr": true,
  "dashscope_api_key": "sk-xxxxxxxxxxxxxxxx",

  "wechatcom_corp_id": "YOUR_CORP_ID",
  "wechatcomapp_secret": "YOUR_APP_SECRET",
  "wechatcomapp_agent_id": "YOUR_AGENT_ID",
  "wechatcomapp_token": "YOUR_TOKEN",
  "wechatcomapp_aes_key": "YOUR_AES_KEY"
}
```

**完整配置（包含高级选项）：**
```json
{
  "channel_type": "wechatcom_app",
  "model": "dify",
  "voice_to_text": "ali",
  "speech_recognition": true,
  "group_speech_recognition": true,
  "use_qwen3_asr": true,
  "dashscope_api_key": "sk-xxxxxxxxxxxxxxxx",
  "qwen3_model": "qwen3-asr-flash",
  "qwen3_language": null,
  "qwen3_enable_lid": true,
  "qwen3_enable_itn": false,
  "qwen3_stream": false,

  "wechatcom_corp_id": "YOUR_CORP_ID",
  "wechatcomapp_secret": "YOUR_APP_SECRET",
  "wechatcomapp_agent_id": "YOUR_AGENT_ID",
  "wechatcomapp_token": "YOUR_TOKEN",
  "wechatcomapp_aes_key": "YOUR_AES_KEY"
}
```

## 🔑 获取 API Key

1. 访问：https://bailian.console.aliyun.com/
2. 登录阿里云账号
3. 进入 **API-KEY 管理**
4. 点击 **创建新的 API Key**
5. 复制生成的 Key（格式：sk-xxxxxxxxxxxxxxxx）

## 🎯 配置说明

| 配置项 | 必填 | 默认值 | 说明 |
|--------|------|--------|------|
| `use_qwen3_asr` | ✅ | `false` | 设为 `true` 启用 Qwen3-ASR |
| `dashscope_api_key` | ✅ | - | 阿里云百炼平台的 API Key |
| `qwen3_model` | ❌ | `"qwen3-asr-flash"` | 模型名称 |
| `qwen3_language` | ❌ | `null` | 语种（`null`=自动检测，`"zh"`=中文，`"en"`=英文） |
| `qwen3_enable_lid` | ❌ | `true` | 是否启用语种识别 |
| `qwen3_enable_itn` | ❌ | `false` | 是否启用数字转换（如"一千"→"1000"） |
| `qwen3_stream` | ❌ | `false` | 是否启用流式输出 |

## 💡 常用配置场景（都在主 config.json 中配置）

### 场景1：默认配置（自动检测语种）
```json
{
  "voice_to_text": "ali",
  "speech_recognition": true,
  "use_qwen3_asr": true,
  "dashscope_api_key": "sk-xxxxxxxxxxxxxxxx"
}
```

### 场景2：中文专用（更快）
```json
{
  "voice_to_text": "ali",
  "speech_recognition": true,
  "use_qwen3_asr": true,
  "dashscope_api_key": "sk-xxxxxxxxxxxxxxxx",
  "qwen3_language": "zh",
  "qwen3_enable_lid": false
}
```

### 场景3：启用数字转换
```json
{
  "voice_to_text": "ali",
  "speech_recognition": true,
  "use_qwen3_asr": true,
  "dashscope_api_key": "sk-xxxxxxxxxxxxxxxx",
  "qwen3_enable_itn": true
}
```
效果："二零二五年一月" → "2025年1月"

## 🔄 如何切换回传统 ASR

在主配置文件 `config.json` 中设置：
```json
{
  "use_qwen3_asr": false
}
```

## ✨ 就这么简单！

配置完成后，重启项目即可使用 Qwen3-ASR 进行语音识别。

